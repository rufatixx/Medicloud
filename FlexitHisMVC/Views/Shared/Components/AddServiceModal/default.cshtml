

@model Medicloud.ViewModels.AddServiceModalViewModel
@*@{
        var headingGroups = Model.ServiceGroups.Where(g => g.isHeading).ToList();
    }*@

<div class="modal fade" id="addServiceToPatient" data-backdrop="static" data-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-fullscreen">
        <div class="modal-content">
            <div class="modal-header bg-primary text-white">
                <h5 class="modal-title" id="staticBackdropLabel">
                    <img src="/res/pencil.svg" style="width: 30px; height: 30px;" />
                    Xidmətin karta əlavə edilməsi
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">


                <form id="addServiceForm" novalidate>
                    <div class="row">

                        <div class="col-md-3">
                            <div class="card" style="max-height:60vh;">
                                <ul class="nav nav-tabs nav-bordered" role="tablist">
                                    <li class="nav-item" role="presentation">
                                        <a data-bs-toggle="tab" class="nav-link active py-2" aria-selected="true" role="tab">
                                            Qruplar
                                        </a>
                                    </li>
                                </ul>
                                <div class="list-group overflow-auto" id="cGroups">
                                    @*<div class="accordion" id="accordionExample">
                                            @foreach (var heading in headingGroups)
                                            {
                                                var childGroups = Model.ServiceGroups.Where(g => !g.isHeading && g.parent == heading.ID).ToList();

                                                <div class="accordion-item">
                                                    <h2 class="accordion-header" id="heading@(heading.ID)">
                                                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse@(heading.ID)" aria-expanded="false" aria-controls="collapse@(heading.ID)">
                                                            @heading.name
                                                        </button>
                                                    </h2>
                                                    <div id="collapse@(heading.ID)" class="accordion-collapse collapse" aria-labelledby="heading@(heading.ID)" data-bs-parent="#accordionExample">
                                                        <div class="accordion-body">
                                                            @foreach (var child in childGroups)
                                                            {
                                                                <div class="accordion-item">
                                                                    <a class="list-group-item list-group-item-action group-item" href="#" data-child-id="@child.ID">
                                                                        @child.name
                                                                    </a>

                                                                    <div class="accordion-collapse collapse" id="collapse@(child.ID)" aria-labelledby="heading@(child.ID)" data-bs-parent="#collapse@(heading.ID)">
                                                                        <div class="accordion-body">
                                                                        </div>
                                                                    </div>


                                                                </div>
                                                            }
                                                        </div>
                                                    </div>
                                                </div>
                                            }
                                        </div>*@
                                </div>

                            </div>
                        </div>

                        <div class="col-md-5">
                            <div class="card " style="max-height:60vh;">
                                <ul class="nav nav-tabs nav-bordered" role="tablist">
                                    <li class="nav-item" role="presentation">
                                        @*<a data-bs-toggle="tab" class="nav-link active py-2" aria-selected="true" role="tab" onclick="settingsBoxClicked(1)">*@
                                        <a data-bs-toggle="tab" class="nav-link active py-2" aria-selected="true" role="tab">
                                            Xidmətlər
                                        </a>
                                    </li>
                                </ul>
                                <div class="card-header border-bottom">
                                    <div class="row align-items-center">
                                        <div class="col-md-10">
                                            <!-- Начало блока поиска -->
                                            <div class="app-search">
                                                @*<form>*@
                                                <div class="d-flex align-items-center">
                                                    <input type="search" class="form-control" id="serviceSearch" placeholder="Axtar...">
                                                    @*<span class="ms-2 mdi mdi-magnify search-icon " style=""></span>*@
                                                </div>
                                                @*</form>*@
                                            </div>
                                            <!-- Конец блока поиска -->
                                        </div>
                                        <div class="col-md-2">
                                            <div class="form-check text-md-end">
                                                <input class="form-check-input" type="checkbox" id="showAllServices" checked>
                                                <label class="form-check-label" for="showAllServices">Hamısı</label>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                                <div class="row p-2 ">
                                    <div class="col-md-6 text-left">
                                        <strong class="text-primary">ADI</strong>
                                    </div>
                                    <div class="col-md-6 d-flex justify-content-end">
                                        <strong class="text-primary">KODU</strong>
                                    </div>
                                </div>
                                <div class="card-body border-top overflow-auto p-0">

                                    <div class="list-group rounded-0" id="servicesInGroup">
                                        @*@if (Model.Services != null)
                    {
                        foreach (var service in Model.Services)
                        {
                            <li class="list-group-item list-group-item-action d-flex justify-content-between"
                                data-id="@service.ID"
                                data-name="@service.name"
                                data-price="@service.price"
                                data-code="@service.code"
                                data-servicetypeid="@service.serviceTypeID"
                                data-depid=""
                                data-servicegroupid="@service.serviceGroupID"
                                data-isactive="@service.isActive.ToString().ToLower()">
                                <div>@service.name</div>
                                <div>@(string.IsNullOrEmpty(service.code) ? "-" : service.code)</div>
                            </li>
                        }
                    }*@
                                    </div>


                                </div>
                            </div>
                            <div class="">
                                <input id="serviceIdInService" type="number" class="form-control d-none" required />
                                <div class="invalid-feedback">
                                    Xidmət seçilməyib
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            @if (Model.Departments != null && Model.Departments.Count > 0)
                            {
                                <div class="card " style="max-height:30vh;">

                                    <ul class="nav nav-tabs nav-bordered" role="tablist">
                                        <li class="nav-item" role="presentation">
                                            @*<a data-bs-toggle="tab" class="nav-link active py-2" aria-selected="true" role="tab" onclick="settingsBoxClicked(1)">*@
                                            <a data-bs-toggle="tab" class="nav-link active py-2" aria-selected="true" role="tab">
                                                Şöbələr
                                            </a>
                                        </li>
                                    </ul>


                                    <div class="row p-2">
                                        <div class="col-md-6 text-left">
                                            <strong class="text-primary">ADI</strong>
                                        </div>
                                    </div>
                                    <div class="card-body border-top overflow-auto p-0">

                                        <div class="list-group rounded-0" id="depsInService">
                                            <!-- Отделы здесь -->
                                        </div>
                                    </div>
                                </div>
                            }

                            <!--<div class="card " style="max-height:30vh;">
    <ul class="nav nav-tabs nav-bordered" role="tablist">
        <li class="nav-item" role="presentation">-->
                            @*<a data-bs-toggle="tab" class="nav-link active py-2" aria-selected="true" role="tab" onclick="settingsBoxClicked(1)">*@
                            <!--<a data-bs-toggle="tab" class="nav-link active py-2" aria-selected="true" role="tab" >
                Yönəldən Həkimlər
            </a>
        </li>
    </ul>
    <div class="row p-2">
        <div class="col-md-6 text-left">
            <strong class="text-primary">ADI</strong>
        </div>
    </div>
    <div class="card-body border-top overflow-auto  p-0">

        <div class="list-group rounded-0" id="refererDocsInCard">-->
                            <!-- Докторы здесь -->
                            <!--</div>
        </div>
    </div>-->
                            <div class="card " style="max-height:30vh;">
                                <ul class="nav nav-tabs nav-bordered" role="tablist">
                                    <li class="nav-item" role="presentation">
                                        @*<a data-bs-toggle="tab" class="nav-link active py-2" aria-selected="true" role="tab" onclick="settingsBoxClicked(1)">*@
                                        <a data-bs-toggle="tab" class="nav-link active py-2" aria-selected="true" role="tab">
                                            Həkimlər
                                        </a>
                                    </li>
                                </ul>
                                <div class="row p-2">
                                    <div class="col-md-6 text-left">
                                        <strong class="text-primary">ADI</strong>
                                    </div>
                                </div>
                                @{
                                    int doctorId = 0;
                                }
                                <div class="card-body border-top overflow-auto  p-0">

                                    <ul class="list-group rounded-0" id="docsInService">

                                        @if (Model.Doctors != null)
                                        {


                                            @if (Model.Doctors.Count == 1)
                                            {
                                                doctorId = Model.Doctors[0].ID;
                                            }
                                            @foreach (var item in Model.Doctors)
                                            {
                                                <li class="list-group-item doctor-item @(doctorId>0?"active":"")" data-item-id="@item.ID">@item.name @item.surname (@item.speciality.name)</li>
                                            }
                                        }
                                    </ul>
                                </div>
                            </div>
                            <div class="">
                                <input id="doctorIdInService" value="@(doctorId > 0 ? doctorId :"")" type="number" class="form-control d-none" required />
                                <div class="invalid-feedback">
                                    Həkim seçilməyib
                                </div>
                            </div>
                        </div>

                    </div>
                </form>
                <h5 class="mt-4">Əlavə olunmuş xidmətlər</h5>
                <div class="table-responsive">
                    <table class="table table-striped">
                        <thead class="table-dark">
                            <tr>
                                <th>#</th>
                                <th>Kodu</th>
                                <th>Xidmət</th>
                                <th>Qiymət</th>
                                @*<th>Yönəldən həkim</th>*@
                                <th>Xidmət edən həkim</th>

                            </tr>
                        </thead>
                        <tbody id="servicesList">
                            <!-- Динамические данные будут заполняться здесь -->
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer  sticky-bottom">
                <button type="button" class="btn btn-success" onclick="insertServiceToPatientCard()">
                    Əlavə et
                </button>
            </div>
        </div>
    </div>
</div>
