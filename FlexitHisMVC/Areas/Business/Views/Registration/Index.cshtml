@{
    Layout = "~/Areas/Business/Views/Shared/_BusinessLayout.cshtml";
}

@model Medicloud.ViewModels.CreateOrganizationVM


<div class="">
    <div class="row  text-center justify-content-center">
        <div class="">
            <form id="step1Form" method="post" enctype="multipart/form-data" asp-action="step2" asp-controller="registration" asp-area="Business">
                <div class="card-header">
                    <input type="hidden" asp-for="id" />

                    @*<button class="btn btn-sm">
                            <img src="~/arrow.svg" />

                        </button>*@
                    <div class="text-center">
                        <h1>Biznesiniz nədir?</h1>
                        <p>Biznesinizə uyğun olan kateqoriyanı seçin</p>
                    </div>
                </div>
                <div class="card-body ">
                    <div class="alert alert-danger" role="alert" id="errorMessage" style="display:none;">
                        Zəhmət olmasa, ən azı bir kateqoriya seçin.
                    </div>
                    <div class="row">
                        @for (int i = 0; i < 6 && i < Model.Categories.Count; i++)
                        {
                            var category = Model.Categories[i];
                            <div class="col-md-4">
                                <div class="form-check mb-3">
                                    <input type="checkbox" style="cursor:pointer;" class="form-check-input" name="SelectedCategories" value="@category.id"
                                           @(Model.SelectedCategories.Contains(category.id) ? "checked" : "")
                                           id="checkInput@(category.id)">

                                    <label class="form-check-label" style="cursor:pointer;" for="checkInput@(category.id)">
                                        <img class="rounded-circle" style="object-fit:cover;" height="120" width="120" src="~/barbershop.jpg" />
                                        <div>
                                            @category.name
                                        </div>

                                    </label>
                                </div>

                            </div>
                        }
                    </div>


                    <div class="row">
                        @foreach (var category in Model.Categories.Skip(6))
                        {
                            <div class="col-12">
                                <div class="form-check text-start mb-2">
                                    <input type="checkbox" style="cursor:pointer;" class="form-check-input" name="SelectedCategories" value="@category.id" id="checkInput@(category.id)"
                                           @(Model.SelectedCategories.Contains(category.id) ? "checked" : "")>
                                    <label class="form-check-label " style="cursor:pointer;" for="checkInput@(category.id)">@category.name</label>
                                </div>
                            </div>
                        }
                    </div>

                </div>

                <div class="mb-3 mb-0 text-center">
                    <button class="btn btn-primary" type="submit" id="nextButton"> Növbəti</button>
                </div>

            </form>
        </div>
    </div>
</div>

@section Scripts{
    <script>
        const $form = $('#step1Form');
        const $nextButton = $('#nextButton');
        const $checkboxes = $("input[name='SelectedCategories']");
        const $errorMessage = $("#errorMessage");

        $form.on('submit', function (event) {
            // Prevent the form from submitting immediately
            event.preventDefault();

            // Check if at least one checkbox is selected
            const selectedCategories = $("input[name='SelectedCategories']:checked");

            if (selectedCategories.length === 0) {
                // If no categories are selected, show an error message
                $errorMessage.show();

                // Apply red border to all checkboxes
                $checkboxes.css("border", "1px solid red");

                return false; // Stop form submission
            }

            // If categories are selected, submit the form
            $form.off('submit').submit();
        });

        // When any checkbox is changed, remove the red border from all checkboxes
        $checkboxes.on('change', function () {
            $checkboxes.css("border", "none");
            $errorMessage.hide();

        });


    </script>
}